---
phase: 01-foundation-architecture
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - tsconfig.json
  - .gitignore
autonomous: true

must_haves:
  truths:
    - "Developer can install package dependencies using npm install"
    - "TypeScript strict mode is enabled and catches type errors"
    - "Project targets ES2020 for Node.js 18+ and modern browser support"
  artifacts:
    - path: "package.json"
      provides: "Package metadata, scripts, devDependencies"
      contains: "tsdown, vitest, biome, typescript"
    - path: "tsconfig.json"
      provides: "TypeScript compiler configuration"
      contains: "strict: true, isolatedDeclarations: true"
    - path: ".gitignore"
      provides: "Git ignore patterns"
      contains: "node_modules, dist"
  key_links:
    - from: "package.json"
      to: "tsconfig.json"
      via: "TypeScript compiler reads config"
      pattern: "tsc --noEmit"
---

<objective>
Establish package configuration and TypeScript foundation with strict mode and dual ESM/CommonJS support.

Purpose: Create the package.json and tsconfig.json that enforce zero dependencies, strict types (DX-01, DX-02), and ES2020 target (PLAT-01-09). This prevents Pitfall #3 (missing strict mode) and Pitfall #4 (wrong exports field).

Output: Working package.json with correct conditional exports, tsconfig.json with strict mode enabled, and .gitignore for common build artifacts.
</objective>

<execution_context>
@/Users/medelman/.claude/get-shit-done/workflows/execute-plan.md
@/Users/medelman/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@/Users/medelman/GitHub/medelman17/eyecitets/.planning/PROJECT.md
@/Users/medelman/GitHub/medelman17/eyecitets/.planning/ROADMAP.md
@/Users/medelman/GitHub/medelman17/eyecitets/.planning/phases/01-foundation-architecture/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Create package.json with conditional exports and zero runtime dependencies</name>
  <files>package.json</files>
  <action>
Create package.json with:
- name: "eyecite-ts"
- version: "0.1.0"
- type: "module" (ESM-first)
- Conditional exports field with TYPES FIRST ordering (Pitfall #4):
  ```json
  "exports": {
    ".": {
      "types": "./dist/index.d.ts",
      "import": "./dist/index.mjs",
      "require": "./dist/index.cjs"
    },
    "./data": {
      "types": "./dist/data/index.d.ts",
      "import": "./dist/data/index.mjs",
      "require": "./dist/data/index.cjs"
    }
  }
  ```
- main: "./dist/index.cjs", module: "./dist/index.mjs", types: "./dist/index.d.ts"
- files: ["dist"] (only ship built artifacts)
- sideEffects: false (enable tree-shaking - Pitfall #2)
- devDependencies ONLY (zero runtime dependencies - PERF-03):
  - typescript@^5.9
  - tsdown@^0.20
  - vitest@^4.0
  - @vitest/coverage-v8@^4.0
  - biome@^2.3
  - size-limit@latest
- scripts:
  - build: "tsdown"
  - test: "vitest"
  - typecheck: "tsc --noEmit"
  - lint: "biome lint src tests"
  - format: "biome format --write src tests"
  - size: "size-limit"
- size-limit config enforcing <50KB:
  ```json
  "size-limit": [
    {
      "path": "dist/index.mjs",
      "limit": "50 KB"
    }
  ]
  ```
- engines: { "node": ">=18.0.0" }
- keywords: ["legal", "citation", "extraction", "typescript", "eyecite"]
- license: "MIT"
- repository, author as appropriate

Why this structure: Conditional exports with types-first ordering ensures TypeScript consumers get types correctly (Pitfall #4). sideEffects: false enables tree-shaking for reporter database (Pitfall #2). Zero runtime deps satisfies PERF-03.
  </action>
  <verify>cat package.json | grep -E '"type".*"module"|"sideEffects".*false|"strict"' and verify devDependencies section has 6 packages, dependencies section is absent</verify>
  <done>package.json exists with correct exports field ordering (types before import/require), zero runtime dependencies verified, size-limit configured for 50KB</done>
</task>

<task type="auto">
  <name>Create tsconfig.json with strict mode and ES2020 target</name>
  <files>tsconfig.json</files>
  <action>
Create tsconfig.json with strict TypeScript configuration:
```json
{
  "compilerOptions": {
    "strict": true,
    "isolatedDeclarations": true,
    "declaration": true,
    "declarationMap": true,
    "module": "ESNext",
    "target": "ES2020",
    "moduleResolution": "bundler",
    "lib": ["ES2020", "DOM"],
    "skipLibCheck": true,
    "esModuleInterop": true,
    "noEmit": true,
    "outDir": "dist",
    "rootDir": "src"
  },
  "include": ["src"],
  "exclude": ["node_modules", "dist", "tests"]
}
```

Why this config:
- strict: true → Prevents Pitfall #3 (no any types, satisfies DX-01/DX-02)
- isolatedDeclarations: true → Fast .d.ts generation via oxc in tsdown
- target: ES2020 → Enables modern regex (lookbehind, named groups) for citation patterns, satisfies PLAT-01-05
- moduleResolution: "bundler" → Correct resolution for tsdown bundler workflow
- lib: ["ES2020", "DOM"] → Both Node.js and browser APIs available (PLAT-01-05)
- noEmit: true → Build handled by tsdown, not tsc
  </action>
  <verify>cat tsconfig.json | grep -E '"strict".*true|"isolatedDeclarations".*true|"target".*"ES2020"'</verify>
  <done>tsconfig.json exists with strict mode enabled, isolatedDeclarations for fast type generation, ES2020 target for modern regex support</done>
</task>

<task type="auto">
  <name>Create .gitignore for build artifacts and dependencies</name>
  <files>.gitignore</files>
  <action>
Create .gitignore with:
```
# Dependencies
node_modules/

# Build output
dist/
*.tsbuildinfo

# Test coverage
coverage/

# Editor
.vscode/
.idea/
*.swp
*.swo
*~

# OS
.DS_Store
Thumbs.db

# Logs
*.log
npm-debug.log*
```

Standard Node.js library ignore patterns. Include dist/ since this is a library (consumers install from npm, not git).
  </action>
  <verify>test -f .gitignore && grep -q "node_modules" .gitignore && grep -q "dist" .gitignore</verify>
  <done>.gitignore exists with node_modules and dist patterns</done>
</task>

</tasks>

<verification>
Run these checks after all tasks complete:
1. `cat package.json | jq '.devDependencies | length'` returns 6 (six dev dependencies)
2. `cat package.json | jq '.dependencies'` returns null (zero runtime dependencies - PERF-03)
3. `cat package.json | jq '.sideEffects'` returns false (tree-shaking enabled)
4. `cat tsconfig.json | jq '.compilerOptions.strict'` returns true (DX-01/DX-02)
5. `cat tsconfig.json | jq '.compilerOptions.target'` returns "ES2020" (PLAT-01-05)
6. `test -f .gitignore && echo "exists"` returns "exists"
</verification>

<success_criteria>
Package foundation complete when:
- package.json has conditional exports with types-first ordering
- Zero runtime dependencies verified (only devDependencies section exists)
- TypeScript strict mode enabled in tsconfig.json
- ES2020 target configured for modern regex support
- .gitignore prevents committing node_modules and build artifacts
- All verification commands pass
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-architecture/01-01-SUMMARY.md`
</output>
