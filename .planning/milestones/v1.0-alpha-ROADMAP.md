# Milestone v1.0-alpha: Feature Parity with Python eyecite

**Status:** SHIPPED 2026-02-05
**Phases:** 1-4
**Total Plans:** 17

## Overview

eyecite-ts delivers a TypeScript legal citation extraction library with feature parity to Python eyecite, shipping in a sub-50KB browser-compatible bundle. The roadmap progressed from architectural foundation (Phase 1) through core parsing logic (Phase 2), reporter database integration (Phase 3), to short-form resolution and comprehensive validation (Phase 4), culminating in a production-ready v1.0-alpha release.

## Phases

### Phase 1: Foundation & Architecture

**Goal**: Establish project scaffolding, architectural contracts, and design decisions that prevent costly rework
**Depends on**: Nothing (first phase)
**Requirements**: PLAT-01 through PLAT-09, PERF-03, DX-01, DX-02
**Plans**: 3 plans

Plans:
- [x] 01-01-PLAN.md - Package and TypeScript configuration with strict mode and conditional exports
- [x] 01-02-PLAN.md - Build tooling (tsdown, Biome, Vitest) with dual ESM/CJS output
- [x] 01-03-PLAN.md - Type system (Span, Citation unions) and architecture documentation

**Success Criteria (all met):**
1. Developer can install package and import types in both Node.js 18+ and modern browsers
2. TypeScript strict mode catches type errors in public API (zero `any` types exposed)
3. Build produces ESM and CommonJS bundles with tree-shakeable exports
4. Project has zero runtime dependencies verified by package.json
5. Position offset tracking architecture documented and ready for implementation

### Phase 2: Core Parsing

**Goal**: Implement core citation detection, tokenization, metadata extraction, and text cleaning with ReDoS protection
**Depends on**: Phase 1
**Requirements**: DET-01 through DET-09, DET-16 through DET-22, META-01 through META-08, CLN-01 through CLN-06
**Plans**: 6 plans

Plans:
- [x] 02-01-PLAN.md - Text cleaning layer with position tracking (cleanText, built-in cleaners)
- [x] 02-02-PLAN.md - Regex patterns for all citation types with ReDoS protection
- [x] 02-03-PLAN.md - Tokenization layer applying patterns to cleaned text
- [x] 02-04-PLAN.md - Citation type system extension (journal, neutral, public law, federal register)
- [x] 02-05-PLAN.md - Citation extraction with metadata parsing and confidence scoring
- [x] 02-06-PLAN.md - Main pipeline (extractCitations API) with integration tests

**Success Criteria (all met):**
1. Developer can extract full case citations with volume, reporter, page, court, date, and pincite
2. Developer can extract U.S. Code, state code, public law, Federal Register, and journal citations
3. All extracted citations include matched text, span positions, and structured metadata
4. Developer can clean text (strip HTML, normalize whitespace, remove OCR artifacts) with custom functions
5. No citation pattern triggers >100ms parse time (ReDoS protection validated at 2ms total)

### Phase 3: Reporter Database & Annotation

**Goal**: Integrate reporter database, optimize bundle size, implement position-aware annotation, validate performance constraints
**Depends on**: Phase 2
**Requirements**: DATA-01 through DATA-05, ANN-01 through ANN-04, PERF-01, PERF-02
**Plans**: 4 plans

Plans:
- [x] 03-01-PLAN.md - Reporter database loader with lazy loading and Map-based O(1) lookup
- [x] 03-02-PLAN.md - Annotation API with callback and template modes, auto-escaping
- [x] 03-03-PLAN.md - Citation validation with confidence scoring and degraded mode
- [x] 03-04-PLAN.md - Bundle optimization, performance validation, integration tests

**Success Criteria (all met):**
1. Developer can extract citations validated against reporters-db (1,235 reporters recognized)
2. Core bundle size is <50KB gzipped (achieved: 4.2KB)
3. Library processes 10KB legal document in <100ms (achieved: <49ms)
4. Developer can annotate citations with before/after markup or custom functions
5. Annotation preserves HTML/XML markup and handles entities correctly

### Phase 4: Short-Form Resolution & Integration

**Goal**: Resolve Id., Supra, and short-form citations to antecedents with document-scoped state, complete testing and documentation
**Depends on**: Phase 3
**Requirements**: DET-10 through DET-15, RES-01 through RES-06, DX-03, DX-04
**Plans**: 4 plans

Plans:
- [x] 04-01-PLAN.md - Short-form detection patterns (Id./Ibid./supra) with types and ReDoS protection
- [x] 04-02-PLAN.md - Short-form extraction functions and tokenizer integration
- [x] 04-03-PLAN.md - DocumentResolver with Levenshtein matching, scope boundaries, and full resolution
- [x] 04-04-PLAN.md - Pipeline integration with resolve option, integration tests, and README docs

**Success Criteria (all met):**
1. Developer can detect Id., Ibid., and supra citations in text
2. Id. citations resolve to immediately preceding citation respecting paragraph boundaries
3. Supra citations resolve to earlier full citation by party name matching (with spelling variations)
4. Short-form citations resolve by reporter and page with volume validation
5. Parallel parsing has no state leakage (document-scoped resolver verified)
6. API documentation includes examples, error messages guide invalid input

## Progress

| Phase | Plans Complete | Status | Completed |
|-------|----------------|--------|-----------|
| 1. Foundation & Architecture | 3/3 | Complete | 2026-02-05 |
| 2. Core Parsing | 6/6 | Complete | 2026-02-05 |
| 3. Reporter Database & Annotation | 4/4 | Complete | 2026-02-05 |
| 4. Short-Form Resolution & Integration | 4/4 | Complete | 2026-02-05 |

---

## Milestone Summary

**Key Decisions:**
- TypeScript strict mode with zero runtime dependencies
- Dual position tracking (clean vs. original text) via TransformationMap
- Broad tokenization patterns + strict extraction validation (separation of concerns)
- Simple regex without nested quantifiers for ReDoS prevention (validated at 2ms)
- Lazy-loaded reporter database keeps core bundle at 4.2KB gzipped
- Levenshtein distance for fuzzy party name matching (0.8 threshold)
- Auto-escape annotation defaults for XSS prevention

**Issues Resolved:**
- Token deduplication for overlapping pattern matches
- Pattern ordering (specific before broad) for correct citation type detection
- Party name extraction via lookback algorithm
- Id. resolution scoped to case citations only (not statutes/journals)

**Issues Deferred:**
- Complex Unicode edge cases (emoji, combining characters, RTL)
- Enhanced parenthetical extraction patterns
- Streaming extraction for large documents (v2)
- International citation formats (v2)

**Technical Debt Incurred:**
- State reporter pattern is broad (mitigated by reporters-db validation)
- Journal pattern is broad (mitigated by journals-db validation)

---

_For current project status, see .planning/PROJECT.md_
